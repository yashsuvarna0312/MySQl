-- Join 
-- Date : 9 dec 2025 
create database cwpc9090;
use cwpc9090;
CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100)
);
CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    OrderDate DATE,
    TotalAmount DECIMAL(10, 2)
);

INSERT INTO Customers (CustomerID, FirstName, LastName, Email)
VALUES
    (1, 'Pankaj', 'Sharma', 'pankaj@codeswithpankaj.com'),
    (2, 'Nishant', 'Patel', 'nishant@codeswithpankaj.com'),
    (3, 'Kiran', 'Desai', 'kiran@codeswithpankaj.com'),
    (4, 'Tanvi', 'Mehta', 'tanvi@codeswithpankaj.com'),
    (5, 'Kritek', 'Singh', 'kritek@codeswithpankaj.com'),
    (7, 'Pooja', 'jain', 'pooja@codeswithpankaj.com');

INSERT INTO Orders (OrderID, CustomerID, OrderDate, TotalAmount)
VALUES
    (101, 1, '2023-01-15', 250.00),
    (102, 2, '2023-02-20', 120.50),
    (103, 3, '2023-03-10', 320.75),
    (104, 1, '2023-04-05', 175.25),
    (105, 4, '2023-05-12', 210.00),
    (106, 6, '2023-10-12', 850.00);

select * from customers;
select * from orders;

-- inner join
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers inner join orders 
on customers.customerid = orders.customerid;

-- left join
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers left join orders 
on customers.customerid = orders.customerid;

-- right join
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers right join orders 
on customers.customerid = orders.customerid;

-- full join
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers left join orders 
on customers.customerid = orders.customerid
union
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers right join orders 
on customers.customerid = orders.customerid;


-- view 

create view  joinhub as
-- full join
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers left join orders 
on customers.customerid = orders.customerid
union
select customers.firstname , customers.email , 
orders.orderid , orders.totalamount,orders.orderdate
from customers right join orders 
on customers.customerid = orders.customerid;

-- call view

select * from joinhub;

use classicmodels;

select count(*) from customers;
-- avg()
select avg(creditlimit) from customers;
-- MIN()
select min(creditlimit) from customers;
-- MAX()
select max(creditlimit) from customers;

-- CONCAT()

select * from customers;

select concat(contactfirstname,' ',contactlastname) as full_name
from customers;

use classicmodels;

-- concat()
select concat(contactfirstname, ' ' ,contactlastname) as full_name from customers;

-- upper()
select upper(contactfirstname) from customers;

-- lower()
select lower(contactfirstname) from customers;

-- left()
select left(contactfirstname, 3) from customers;

-- right()
select right(contactfirstname, 5) from customers;

-- length()
select contactfirstname, length(contactfirstname) from customers;

-- trim()
select trim(contactfirstname), length(trim(contactfirstname)) from customers;

-- replace()
select replace(city, 'ars' , 'qq') as city_replaced from customers;

-- ltrim()
select ltrim(city) AS city_ltrimmed FROM customers;

-- ltrim()
select ltrim(city) AS city_ltrimmed FROM customers;

-- rtrim()
select ltrim(city) AS city_rtrimmed FROM customers;

-- charindex() -- does not work in mysql
select charindex('a', city) as position_of_a from customers;

-- replicate() -- does not work in mysql
select replicate('abc', 3) AS repeated_string FROM customers LIMIT 1;

-- substring()
-- substring(string_expression, start_position, length)
select contactfirstname, substring(contactfirstname, 3, 4) AS First_Name
from customers;

-- reverse
select reverse(city) from customers;

-- format
select creditlimit, format(creditlimit, 2) from customers;
select creditlimit, concat('$',format(creditlimit, 2)) from customers;

-- stuff() -- does not work in mysql
select contactfirstname, stuff(contactfirstname, 3, 4, '34333') AS First_Name
from customers;

-- ascii
select ascii('A') as ascii_value from customers limit 1;

-- unicode -- does not work in mysql -- check one more time
select unicode('A') as unicode_value from customers limit 1;
